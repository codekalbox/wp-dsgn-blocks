(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.i18n,n=((0,t.__)("Default","nectar-blocks"),(0,t.__)("Wrap All","nectar-blocks"),(0,t.__)("Grid Item","nectar-blocks"),(0,t.__)("Featured Media","nectar-blocks"),"nectar-blocks-post-grid"),i=window.wp.apiFetch;var s=e.n(i);class o{loadMorePage=1;currentPage=1;postsPerPage=0;offset=0;blockId="";constructor(e){if(this.element=e,this.blockId=this.element.getAttribute("id"),null===this.blockId)throw new Error("Unable to find block id");const t=this.element.querySelector(`.${n}__content`);if(null===t)throw new Error("Unable to find post-grid content");this.content=t;const i=this.element.querySelector(`.${n}__inner`);if(null===i)throw new Error("Unable to find post-grid inner");this.inner=i;const s=this.element.querySelector(`.${n}__pagination`);if(this.pagination=s,this.element.dataset.offset){const e=parseInt(this.element.dataset.offset);e>0&&(this.offset=e)}this.initPagination()}initPagination(){null!==this.pagination&&void 0!==this.element.dataset.paginationType&&(this.type=this.element.dataset.paginationType,void 0!==this.element.dataset.paginationPostsPerPage?(this.postsPerPage=parseInt(this.element.dataset.paginationPostsPerPage),"load-more"===this.type?this.initializeLoadMore():this.initializeNumbered()):console.warn("PostsPerPage in post-grind not found"))}initializeLoadMore(){const e=this.element.querySelector(`.${n}__pagination__load-more`);null!==e?e.addEventListener("click",(async()=>{if(this.element.classList.contains("loading"))return;this.loadMorePage=this.loadMorePage+1,this.element.classList.add("loading");const e=await s()({path:"/nectar/v1/post_renderer/render",method:"POST",data:{pageID:window.nectarBlocksData.postID,blockID:this.blockId,overrideAttrs:{postOffset:this.currentPage-1+this.postsPerPage+this.offset,current_page:this.loadMorePage}}});if(this.currentPage=this.currentPage+this.postsPerPage,"success"===e.status){const t=document.createElement("div");t.innerHTML=e.html;const i=t.querySelector(`.${n}__content`),s=t.querySelector(`.${n}__pagination`);if(null===i||null===s)return void console.warn("Unable to find post-grid content");this.content?.append(...i.children),this.pagination.innerHTML=s.innerHTML,this.initializeLoadMore()}else console.warn(e.message);this.element.classList.remove("loading")})):console.warn("Unable to find post-grid button")}initializeNumbered(){const e=this.element.querySelectorAll("a.page-numbers, button.page-numbers");if(null!==e)for(const t of e){let e;t.classList.contains("dots")||(e=t.classList.contains("prev")?this.currentPage-1:t.classList.contains("next")?this.currentPage+1:parseInt(t.innerText),t.addEventListener("click",(async t=>{if(this.element.classList.contains("nectar-inherit-query"))return!0;if(t.preventDefault(),this.element.classList.contains("loading"))return;this.element.classList.add("loading");const i=(e-1)*this.postsPerPage+this.offset,o=await s()({path:"/nectar/v1/post_renderer/render",method:"POST",data:{pageID:window.nectarBlocksData.postID,blockID:this.blockId,overrideAttrs:{postOffset:i,current_page:e}}});if("success"===o.status){this.currentPage=e;const t=document.createElement("div");t.innerHTML=o.html;const i=t.querySelector(`.${n}__inner`),s=t.querySelector(`.${n}__pagination`);if(null===i||null===s)return void console.warn("Unable to find updated content");this.inner.innerHTML=i.innerHTML,this.pagination.innerHTML=s.innerHTML,this.initializeNumbered(),this.element.getBoundingClientRect().top<0&&this.element.scrollIntoView({behavior:"smooth"})}else console.warn(o.message);return this.element.classList.remove("loading"),!1})))}else console.warn("Unable to find post-grid numbered buttons")}destroy(){}}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(`.${n}`).forEach((e=>{new o(e)}))}))})();