(()=>{"use strict";const t=window.countUp,e=(t,e=1)=>{const n=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],i=(t,e)=>{let n=new RegExp(`${(e[2]?e[2]:"")+e[0]}|${(e[3]?e[3]:"")+e[1]}`,"g");return t.replace(n,(t=>t===e[0]?e[1]:e[0]))};if(e)for(let e=0;e<n.length;++e)t=i(t,n[e]);else for(let e=n.length;e--;)t=i(t,n[e]);return t};class n{mode="frontend";instance=null;constructor(t,n){if(this.element=t,n)this.settings=n,this.mode="editor";else{if(!this.element.dataset.nectarMilestoneAnimation)return;this.settings=JSON.parse((t=>{try{return JSON.parse(t),t}catch(t){}return/[!~$].*[!~$].*[!~$]/.test(t)?(t=>{const n=(t=t.substring(0,t.length-1)).split("");let i=n[0];if(n.length>1){let t=n[1];for(let e of t){let t=i.split(e);i=t.join(t.pop())}}return e(i,0)})(t):t})(this.element.dataset.nectarMilestoneAnimation)),this.element=t.querySelector(".nectar-blocks-milestone__content")}this.init(),this.events()}events(){"editor"!==this.mode&&(window.addEventListener("nectar-blocks-changed-device",this.init.bind(this)),window.addEventListener("nectar-blocks-tabs-tab-changed",(t=>{t.detail.tab.contains(this.element)&&this.instance&&(this.instance.reset(),this.instance.start())})))}init(){if("frontend"===this.mode){if(!this.shouldActivateOnDevice())return;if(this.element.classList.contains("is-animated"))return}this.animation()}animation(){const e=this.element.textContent||"0",n=this.element.textContent?.includes(",")||!1,i=this.element.textContent?.includes(".")?1:0;this.instance=new t.CountUp(this.element,parseFloat(e.replace(/[^0-9.]/g,"")),{decimalPlaces:i,useGrouping:n,duration:this.settings.duration,enableScrollSpy:"frontend"===this.mode,scrollSpyOnce:!0,onCompleteCallback:()=>{this.element.classList.add("is-animated"),window.dispatchEvent(new Event("nectar-blocks-milestone-animation-complete"))}}),this.instance.start()}shouldActivateOnDevice(){var t;const e=null!==(t=window?.nectarBlocksFrontend?.device)&&void 0!==t?t:"";return!(!e||e&&!this.settings.deviceTrigger.includes(e))}destroy(){this.instance&&(this.instance.reset(),this.element.classList.remove("is-animated"))}}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".nectar-blocks-milestone").forEach((t=>{new n(t)}))}))})();